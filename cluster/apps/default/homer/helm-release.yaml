---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: homer
  namespace: default
spec:
  interval: 5m
  chart:
    spec:
      # renovate: registryUrl=https://k8s-at-home.com/charts/
      chart: homer
      version: 4.4.0
      sourceRef:
        kind: HelmRepository
        name: k8s-at-home-charts
        namespace: flux-system
  values:
    image:
      repository: b4bz/homer
      tag: 21.03.2
      pullPolicy: IfNotPresent
    ingress:
      enabled: true
      annotations:
        kubernetes.io/ingress.class: "nginx"
        cert-manager.io/cluster-issuer: "letsencrypt-prod"
        nginx.ingress.kubernetes.io/proxy-body-size: "20m"
        nginx.ingress.kubernetes.io/auth-url: "https://sso.${SECRET_DOMAIN}/oauth2/auth"
        nginx.ingress.kubernetes.io/auth-signin: "https://sso.${SECRET_DOMAIN}/oauth2/start?rd=https://$host$request_uri"
      hosts:
      - host: "homer.${SECRET_DOMAIN}"
        paths:
        - path: /
          pathType: Prefix
      tls:
        - secretName: homer-prod-tls
          hosts:
            - "homer.${SECRET_DOMAIN}"
    configmap:
      enabled: true
      config: |
        title: "App Dashboard"
        subtitle: "Homer"
        documentTitle: "App Dashboard" # Customize the browser tab text
        # logo: "assets/logo.png"
        # Alternatively a fa icon can be provided:
        icon: "fas fa-skull-crossbones"
        header: true # Set to false to hide the header
        footer: '<p>Created with <span class="has-text-danger">❤️</span> with <a href="https://bulma.io/">bulma</a>, <a href="https://vuejs.org/">vuejs</a> & <a href="https://fontawesome.com/">font awesome</a> // Fork me on <a href="https://github.com/bastienwirtz/homer"><i class="fab fa-github-alt"></i></a></p>' # set false if you want to hide it.

        columns: "3" # "auto" or number (must be a factor of 12: 1, 2, 3, 4, 6, 12)
        connectivityCheck: true # whether you want to display a message when the apps are not accessible anymore (VPN disconnected for example)

        # Optional theming
        theme: default # 'default' or one of the themes available in 'src/assets/themes'.

        # Optional custom stylesheet
        # Will load custom CSS files. Especially useful for custom icon sets.
        # stylesheet:
        #   - "assets/custom.css"

        # Here is the exhaustive list of customization parameters
        # However all value are optional and will fallback to default if not set.
        # if you want to change only some of the colors, feel free to remove all unused key.
        colors:
          light:
            highlight-primary: "#3367d6"
            highlight-secondary: "#4285f4"
            highlight-hover: "#5a95f5"
            background: "#f5f5f5"
            card-background: "#ffffff"
            text: "#363636"
            text-header: "#424242"
            text-title: "#303030"
            text-subtitle: "#424242"
            card-shadow: rgba(0, 0, 0, 0.1)
            link-hover: "#363636"
            background-image: "assets/your/light/bg.png"
          dark:
            highlight-primary: "#3367d6"
            highlight-secondary: "#4285f4"
            highlight-hover: "#5a95f5"
            background: "#131313"
            card-background: "#2b2b2b"
            text: "#eaeaea"
            text-header: "#ffffff"
            text-title: "#fafafa"
            text-subtitle: "#f5f5f5"
            card-shadow: rgba(0, 0, 0, 0.4)
            link-hover: "#ffdd57"
            background-image: "assets/your/dark/bg.png"

        # Optional message
        message:
          # url: "https://<my-api-endpoint>" # Can fetch information from an endpoint to override value below.
          # mapping: # allows to map fields from the remote format to the one expected by Homer
          #   title: 'id' # use value from field 'id' as title
          #   content: 'value' # value from field 'value' as content
          # refreshInterval: 10000 # Optional: time interval to refresh message
          #
          # Real example using chucknorris.io for showing Chuck Norris facts as messages:
          # url: https://api.chucknorris.io/jokes/random
          # mapping:
          #   title: 'id'
          #   content: 'value'
          # refreshInterval: 10000
          style: "is-warning"
          title: "Optional message!"
          icon: "fa fa-exclamation-triangle"
          content: "Lorem ipsum dolor sit amet, consectetur adipiscing elit."

        # Optional navbar
        # links: [] # Allows for navbar (dark mode, layout, and search) without any links
        links:
          - name: "link 1"
            icon: "fab fa-github"
            url: "https://github.com/bastienwirtz/homer"
            target: "_blank" # optional html tag target attribute
          - name: "link 2"
            icon: "fas fa-book"
            url: "https://github.com/bastienwirtz/homer"
          # this will link to a second homer page that will load config from page2.yml and keep default config values as in config.yml file
          # see url field and assets/page.yml used in this example:
          - name: "Second Page"
            icon: "fas fa-file-alt"
            url: "#page2"

        # Services
        # First level array represents a group.
        # Leave only a "items" key if not using group (group name, icon & tagstyle are optional, section separation will not be displayed).
        services:
          - name: "Media"
            icon: "fas fa-code-branch"
            # A path to an image can also be provided. Note that icon take precedence if both icon and logo are set.
            # logo: "path/to/logo"
            items:
              - name: "Sonarr"
                logo: "assets/tools/sample.png"
                # Alternatively a fa icon can be provided:
                # icon: "fab fa-jenkins"
                subtitle: "TV Show Fetcher"
                tag: "app"
                url: "https://sonarr.${SECRET_DOMAIN}"
                target: "_blank" # optional html tag target attribute
              
              - name: "Radarr"
                logo: "assets/tools/sample2.png"
                subtitle: "Movie Fetcher"
                tag: "app"
                # Optional tagstyle
                tagstyle: "is-success"
                url: "https://radarr.${SECRET_DOMAIN}"
                target: "_blank"
                
              - name: "Lidarr"
                logo: "assets/tools/sample2.png"
                subtitle: "Music Fetcher"
                tag: "app"
                # Optional tagstyle
                tagstyle: "is-success"
                url: "https://lidarr.${SECRET_DOMAIN}"
                target: "_blank"
                
              - name: "Sabnzbd"
                logo: "assets/tools/sample2.png"
                subtitle: "Downloader"
                tag: "app"
                # Optional tagstyle
                tagstyle: "is-success"
                url: "https://sabnzbd.${SECRET_DOMAIN}"
                target: "_blank"
                
              - name: "Nzbget"
                logo: "assets/tools/sample2.png"
                subtitle: "Other Downloader"
                tag: "app"
                # Optional tagstyle
                tagstyle: "is-success"
                url: "https://nzbget.${SECRET_DOMAIN}"
                target: "_blank"
                
              - name: "NzbHydra"
                logo: "assets/tools/sample2.png"
                subtitle: "Indexer"
                tag: "app"
                # Optional tagstyle
                tagstyle: "is-success"
                url: "https://nzbhydra.${SECRET_DOMAIN}"
                target: "_blank"
                
              - name: "Ombi"
                logo: "assets/tools/sample2.png"
                subtitle: "Request Service"
                tag: "app"
                # Optional tagstyle
                tagstyle: "is-success"
                url: "https://ombi.${SECRET_DOMAIN}"
                target: "_blank"
                
          - name: "Home Automation"
            icon: "fas fa-heartbeat"
            items:
              - name: "Home Assistant"
                logo: "assets/tools/sample.png"
                subtitle: "Home Automation Platform"
                tag: "app"
                url: "https://ha.${SECRET_DOMAIN}"
                target: "_blank" # optional html a tag target attribute
              
              - name: "Homebridge"
                logo: "assets/tools/sample2.png"
                subtitle: "Homekit Aggregator"
                tag: "app"
                # Optional tagstyle
                tagstyle: "is-success"
                url: "https://homebridge.${SECRET_DOMAIN}"
                target: "_blank"
              
              - name: "Node-Res"
                logo: "assets/tools/sample2.png"
                subtitle: "JS GUI"
                tag: "app"
                # Optional tagstyle
                tagstyle: "is-success"
                url: "https://nodered.${SECRET_DOMAIN}"
                target: "_blank"
              